import*as core from"./core.js";export*from"./core.js";let SITE_CONFIG={criticalComponents:["nav"],navigation:{autoCloseOffcanvas:!0,smoothScrolling:!0},analytics:{}};class SiteScrollAnimations{constructor(){this.lenis=null,this.initialized=!1,this.prefersReducedMotion=!1,this.config={duration:{fast:.3,normal:.5,slow:.6},ease:"power2.out",stagger:{cards:.12,list:.08,grid:.1},triggerStart:"top 85%",triggerStartEarly:"top 90%"}}init(){document.body.classList.contains("optimize")||this.initialized||(this.initialized=!0,this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",()=>{this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.prefersReducedMotion&&this.lenis&&(this.lenis.destroy(),this.lenis=null)}),this.initLenis(),this.prefersReducedMotion||document.documentElement.classList.add("js-animations"),this.animateAll(),this.setupResize(),document.addEventListener("component:loaded",()=>{this.animateAll()}))}isTouchDevice(){return document.documentElement.classList.contains("touch-device")}observe(e,t,a){t=t===this.config.triggerStartEarly?"-10%":"-15%";let i=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(a(),i.unobserve(e.target))})},{rootMargin:`0px 0px ${t} 0px`});i.observe(e)}animateOnScroll(t,a,i,n=this.config.triggerStart){if(this.isTouchDevice()){let e=gsap.to(t,{...a,paused:!0});return this.observe(i,n,()=>e.play()),e}return gsap.to(t,{...a,scrollTrigger:{trigger:i,start:n,toggleActions:"play none none none"}})}timelineOnScroll(t,a=this.config.triggerStart){if(this.isTouchDevice()){let e=gsap.timeline({paused:!0});return this.observe(t,a,()=>e.play()),e}return gsap.timeline({scrollTrigger:{trigger:t,start:a,toggleActions:"play none none none"}})}initLenis(){this.isTouchDevice()||this.prefersReducedMotion||"undefined"!=typeof Lenis&&(this.lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),orientation:"vertical",gestureOrientation:"vertical",smoothWheel:!0,wheelMultiplier:1,touchMultiplier:2,infinite:!1}),this.lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{this.lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0))}newElements(e){return gsap.utils.toArray(e).filter(e=>!e.dataset.gsapAnimated&&(e.dataset.gsapAnimated="1",!0))}animateAll(){this.prefersReducedMotion||"undefined"!=typeof gsap&&(this.animateSectionHeaders(),this.animateLabeledDefaults(),this.animateCardItems(),this.animateStats(),this.animateBulletedLists(),this.animateDarkBlocks(),this.animateNumberedGrids(),this.animatePhaseCards(),this.animateFeatureBlocks(),this.animateCapabilityLists(),this.animateBlockquotes(),this.animateCTABlocks(),this.animateProductLists(),this.animateCredibilityText(),this.animateContactPage(),this.animateLeadText(),this.animateArticleCards())}animateSectionHeaders(){this.newElements(".section-header").forEach(e=>{var t=e.querySelector("h2"),a=e.querySelector(".subheadline"),i=e.querySelector(".section-label"),n=this.timelineOnScroll(e);i&&n.to(i,{opacity:1,y:0,duration:this.config.duration.fast,ease:this.config.ease},0),t&&n.to(t,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease,onStart:()=>e.classList.add("in-view")},i?.1:0),a&&n.to(a,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},i?.2:.1)})}animateLabeledDefaults(){document.querySelectorAll(".default-wrapper > p:has(> em) + h2").forEach(e=>{let t=e.closest(".default-wrapper");var a,i;t&&!t.dataset.gsapAnimated&&(t.dataset.gsapAnimated="1",a=e.previousElementSibling,i=this.timelineOnScroll(t),a&&i.to(a,{opacity:1,y:0,duration:this.config.duration.fast,ease:this.config.ease},0),i.to(e,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease,onStart:()=>t.classList.add("in-view")},.1))})}animateCardItems(){var e=this.newElements(".card-item");if(e.length){let a=new Map;e.forEach(e=>{var t=e.closest(".row");a.has(t)||a.set(t,[]),a.get(t).push(e)}),a.forEach((e,t)=>{this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.normal,stagger:this.config.stagger.cards,ease:this.config.ease},t)})}}animateStats(){var e,t=document.querySelector(".stats-bar");t&&!t.dataset.gsapAnimated&&(t.dataset.gsapAnimated="1",this.animateOnScroll(t,{opacity:1,scale:1,duration:this.config.duration.fast,ease:this.config.ease},t),e=t.querySelectorAll(".stat-item"),this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.slow,stagger:this.config.stagger.list,ease:this.config.ease},t),e.forEach(a=>{let i=a.querySelector(".stat-value");if(i){var n=i.textContent.trim().match(/^(\d+)(\+?)$/);if(n){var s=parseInt(n[1],10);let e=n[2]||"",t={value:0};this.animateOnScroll(t,{value:s,duration:1.5,ease:"power1.out",onUpdate(){i.textContent=Math.round(t.value)+e}},a)}}}))}animateBulletedLists(){this.newElements(".bulleted-list").forEach(e=>{var t=e.querySelectorAll("li");this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.fast,stagger:this.config.stagger.list,ease:this.config.ease},e)})}animateDarkBlocks(){this.newElements(".dark-block").forEach(e=>{var t=e.querySelector("h2"),a=e.querySelector(".lead"),i=e.querySelector(".section-label"),n=e.querySelectorAll(".dark-block-list li"),e=this.timelineOnScroll(e);i&&e.to(i,{opacity:1,y:0,duration:this.config.duration.fast,ease:this.config.ease},0),t&&e.to(t,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},.1),a&&e.to(a,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},.2),n.length&&e.to(n,{opacity:1,y:0,duration:this.config.duration.fast,stagger:this.config.stagger.list,ease:this.config.ease},.3)})}animateNumberedGrids(){var e,t=this.newElements(".numbered-step");t.length&&(e=t[0].closest(".numbered-grid"))&&this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.normal,stagger:.2,ease:this.config.ease},e)}animatePhaseCards(){var e,t=this.newElements(".phase-card");t.length&&(e=t[0].closest(".row"))&&this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.normal,stagger:this.config.stagger.cards,ease:this.config.ease},e)}animateFeatureBlocks(){var e=this.newElements(".feature-block");if(e.length){let a=new Map;e.forEach(e=>{var t=e.closest(".row");a.has(t)||a.set(t,[]),a.get(t).push(e)}),a.forEach((e,t)=>{this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.fast,stagger:this.config.stagger.grid,ease:this.config.ease},t)})}}animateCapabilityLists(){this.newElements(".capability-list").forEach(e=>{var t=e.querySelectorAll("li");this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.fast,stagger:.05,ease:this.config.ease},e)})}animateBlockquotes(){this.newElements(".blockquote-feature").forEach(e=>{this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.slow,ease:this.config.ease},e)})}animateCTABlocks(){this.newElements(".cta-block").forEach(e=>{var t=e.querySelector("h2"),a=e.querySelector("p"),i=e.querySelector(".btn"),e=this.timelineOnScroll(e);t&&e.to(t,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},0),a&&e.to(a,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},.1),i&&e.to(i,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},.2)})}animateProductLists(){this.newElements(".product-list").forEach(e=>{var t=e.querySelectorAll("li");this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.fast,stagger:.05,ease:this.config.ease},e)})}animateCredibilityText(){this.newElements(".credibility-text").forEach(e=>{this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},e)})}animateContactPage(){var e,t=document.querySelector(".contact-form-wrapper"),t=(t&&this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},t,this.config.triggerStartEarly),document.querySelector(".contact-info"));t&&(this.animateOnScroll(t,{opacity:1,y:0,duration:this.config.duration.normal,delay:.1,ease:this.config.ease},t,this.config.triggerStartEarly),(e=t.querySelectorAll(".expect-item")).length)&&this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.fast,stagger:this.config.stagger.list,delay:.2,ease:this.config.ease},t,this.config.triggerStartEarly)}animateLeadText(){this.newElements(".lead:not(.hero-content .subheadline)").forEach(e=>{e.closest(".dark-block")||this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.normal,ease:this.config.ease},e)})}animateArticleCards(){var e=this.newElements(".article-card");if(e.length){let a=new Map;e.forEach(e=>{var t=e.closest(".row");a.has(t)||a.set(t,[]),a.get(t).push(e)}),a.forEach((e,t)=>{this.animateOnScroll(e,{opacity:1,y:0,duration:this.config.duration.normal,stagger:this.config.stagger.cards,ease:this.config.ease},t)})}}setupResize(){let e;window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{"undefined"!=typeof ScrollTrigger&&ScrollTrigger.refresh(),this.isTouchDevice()?this.lenis&&(this.lenis.destroy(),this.lenis=null):this.lenis||this.prefersReducedMotion||this.initLenis()},250)})}}function setupNavbarScroll(){let e=document.getElementById("mainNav");function t(){50<window.scrollY?e.classList.add("scrolled"):e.classList.remove("scrolled")}e&&(window.addEventListener("scroll",t,{passive:!0}),t())}let NAVBAR_ANIM_SESSION_KEY="navbar_animated",navbarAnimConfig={angularVelocity:150,staggerDelay:.2,maxRadius:29},finalAngles=[0,72,144,216,288],spiralConfig={duration:1,rotation:90},circleTravel=[270,342,54,126,198],animationOrder=[1,0,4,3,2];function setNavbarFinalState(){var e=document.getElementById("navbarBrand"),t=document.getElementById("navbarLogo"),a=document.querySelectorAll(".navbar-v-group"),i=document.querySelector(".navbar-wheel-group"),n=document.getElementById("navbarBrandText");a.length&&i&&t&&e&&(a.forEach((e,t)=>{e.setAttribute("transform",`rotate(${finalAngles[t]})`)}),i.setAttribute("transform","translate(60,60) rotate(216)"),e.style.transform="scale(1)",e.classList.add("visible"),t.classList.add("visible"),n&&n.classList.add("visible","revealed-instant"),a=e.closest(".navbar")?.querySelector(".navbar-toggler"))&&a.classList.add("visible")}function playNavbarAnimation(){if(!document.body.classList.contains("optimize"))if(sessionStorage.getItem(NAVBAR_ANIM_SESSION_KEY))setNavbarFinalState();else if("undefined"!=typeof gsap){var n=document.getElementById("navbarBrand"),s=document.getElementById("navbarLogo"),o=document.querySelectorAll(".navbar-v-group");let e=document.querySelector(".navbar-wheel-group"),t=document.getElementById("navbarBrandText"),l=(n.style.transform="scale(2)",n.style.transformOrigin="left center",n.classList.add("visible"),s.classList.add("visible"),o.forEach(e=>{e.setAttribute("transform",`rotate(0) translate(0, ${navbarAnimConfig.maxRadius})`)}),t&&(t.classList.remove("revealed","revealed-instant"),t.classList.add("visible")),gsap.timeline({onComplete:()=>{sessionStorage.setItem(NAVBAR_ANIM_SESSION_KEY,"true")}}));o.forEach((a,e)=>{var t=animationOrder.indexOf(e)*navbarAnimConfig.staggerDelay,i=circleTravel[e],n=i/navbarAnimConfig.angularVelocity;let s=finalAngles[e],o={t:0};l.to(o,{t:1,duration:spiralConfig.duration,ease:"power1.in",onUpdate(){var e=o.t,t=e*spiralConfig.rotation,e=e*navbarAnimConfig.maxRadius,e=navbarAnimConfig.maxRadius-e;a.setAttribute("transform",`rotate(${t}) translate(0, ${e.toFixed(2)})`)}},t);e=t+spiralConfig.duration,t=spiralConfig.rotation;let r={angle:t};t+=i;l.to(r,{angle:t,duration:n,ease:"power1.out",onUpdate(){a.setAttribute("transform",`rotate(${r.angle})`)},onComplete(){a.setAttribute("transform",`rotate(${s})`)}},e)});s=Math.max(...animationOrder.map((e,t)=>{e=circleTravel[e]/navbarAnimConfig.angularVelocity;return t*navbarAnimConfig.staggerDelay+spiralConfig.duration+e}));let a={angle:0},i=(l.to(a,{angle:216,duration:3,ease:"power2.out",onUpdate(){e.setAttribute("transform",`translate(60,60) rotate(${a.angle})`)}},s-.5),l.add(()=>{t&&t.classList.add("revealed")},s+2),l.to(n,{scale:1,duration:.8,ease:"power2.out"},s+2.8),n.closest(".navbar")?.querySelector(".navbar-toggler"));i&&l.to(i,{opacity:1,duration:.4,ease:"power2.out",onComplete(){i.classList.add("visible")}},s+3.2),l.play()}}class SiteProgressiveEnhancement extends core.ProgressiveEnhancement{static setupSiteNavigation(){super.setupNavigationBehaviors()}static loadScript(i){return new Promise((e,t)=>{var a=document.createElement("script");a.src=i,a.onload=e,a.onerror=()=>t(new Error("Failed to load "+i)),document.head.appendChild(a)})}static async loadVendorLibraries(){if("undefined"==typeof gsap){try{await SiteProgressiveEnhancement.loadScript("/scripts/gsap.js"),await SiteProgressiveEnhancement.loadScript("/scripts/ScrollTrigger.js"),gsap.registerPlugin(ScrollTrigger),ScrollTrigger.config({ignoreMobileResize:!0}),gsap.config({force3D:!0})}catch(e){console.warn("Failed to load GSAP/ScrollTrigger:",e)}try{await SiteProgressiveEnhancement.loadScript("/scripts/lenis.js")}catch(e){console.warn("Failed to load Lenis:",e)}}}}class SiteOrchestrator extends core.ExecutionOrchestrator{constructor(){super(SITE_CONFIG),this.scrollAnimations=new SiteScrollAnimations}async init(){0<navigator.maxTouchPoints&&document.documentElement.classList.add("touch-device"),this.ensureAllComponentCSS(),this.criticalExecutor.executeImmediate(),this.preloadNonCriticalCSS(),this.deferredLoader.observeNonCriticalComponents(),SiteProgressiveEnhancement.setupSiteNavigation();var e=document.getElementById("mainNav"),e=(e&&(setupNavbarScroll(),["contact"].some(e=>document.body.classList.contains(e))?e.classList.remove("navbar-dark"):e.classList.contains("navbar-dark")||e.classList.add("navbar-dark")),document.addEventListener("component:loaded",e=>{"nav"===e.detail?.componentName&&(setupNavbarScroll(),playNavbarAnimation())}),await SiteProgressiveEnhancement.loadVendorLibraries(),playNavbarAnimation(),this.scrollAnimations.init(),await core.ProgressiveEnhancement.loadHeavyDependencies(),core.ProgressiveEnhancement.setupModalHandlers(),"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname),t=window.location.hostname.endsWith(".nimbusedge.app");return!this.config.analytics?.gtmId||e||t||core.ProgressiveEnhancement.loadGoogleTagManager(this.config.analytics.gtmId),this}}core.ready(()=>{var e=new SiteOrchestrator;e.init(),window.executionOrchestrator=e});